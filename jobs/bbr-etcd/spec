---
name: bbr-etcd

templates:
  # bbr scripts: https://docs.cloudfoundry.org/bbr/
  # backup-lock.sh.erb: bin/bbr/backup-lock
  backup.sh.erb: bin/bbr/backup
  # backup-unlock.sh.erb: bin/bbr/backup-unlock
  pre-restore-lock.sh.erb: bin/bbr/pre-restore-lock
  restore.sh.erb: bin/bbr/restore
  post-restore-unlock.sh.erb: bin/bbr/post-restore-unlock
  # others
  bbr-utils.sh.erb: bin/bbr/bbr-utils.sh

packages:
- etcd
- tools

consumes:
- name: etcd
  type: etcd
  properties:
  - etcd.listen_peer_port
  - etcd.listen_client_grpc_port
  - etcd.store_dir
  - etcd.initial_cluster_token
  - etcd.job_ops_timeout_seconds

properties:
  bbr-etcd.backup_data_before_restore:
    description: "If true, the ETCD data directory will be backed up before restoring data from a snapshot."
    default: "true"
  bbr-etcd.snapshot_filename:
    description: "The name of the file to be used for ETCD data snapshot."
    default: "etcd-snapshot.db"
